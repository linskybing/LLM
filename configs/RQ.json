{
  "train_batch_size": 2,
  "train_micro_batch_size_per_gpu": 1,
  "steps_per_print": 1,
  "gradient_accumulation_steps": 1,
  "optimizer": {
    "type": "ZeroOneAdam",
    "params": {
      "lr": 1e-3,
      "weight_decay": 0.01,
      "bias_correction": false,
      "var_freeze_step": 1000,
      "var_update_scaler": 16,
      "local_step_scaler": 1000,
      "local_step_clipper": 16,
      "cuda_aware": false,
      "comm_backend_name": "nccl"
    }
  },

  "gradient_clipping": 1.0,

  "bf16": {
    "enabled": true
  },

  "quantize_training": {
    "enabled": true,
    "quantize_verbose": true,
    "quantizer_kernel": true,
    "quantize_type": "symmetric",
    "quantize_bits": {
      "start_bits": 16,
      "target_bits": 8
    },
    "quantize_schedule": {
      "quantize_period": 100,
      "schedule_offset": 0
    },
    "quantize_groups": 8
  },

  "activation_checkpointing": {
    "partition_activations": true,
    "contiguous_memory_optimization": true,
    "cpu_checkpointing": false,
    "number_checkpoints": null,
    "synchronize_checkpoint_boundary": true,
    "profile": false
  },
  "gradient_checkpointing": {
    "enable": true
  },

  "flops_profiler": {
    "enabled": false,
    "profile_step": 1,
    "module_depth": -1,
    "top_modules": 1,
    "detailed": true,
    "output_file": null
  },
}
